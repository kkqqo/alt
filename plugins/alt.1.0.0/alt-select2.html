<script>
    Vue.component("select2", {
        template: `<select class="form-control"><slot></slot></select>`,
        props: {
            value: {
                type: String
            }
        },
        mounted() {
            $(this.$el).select2();
            if (value) {
                $(this.$el).val(this.value);
                $(this.$el).trigger('change')
            }

            $(this.$el).on("change", () => {
                var data = $(this.$el).select2('data');

                let v = data.map(s => {
                    return s.id;
                });

                this.$emit("input", v[0]);
            });
        },
        methods: {
            empty() {
                $(this.$el).empty();
            }
        }
    });

    Vue.component("multiselect2", {
        template: `<select class="form-control" multiple><slot></slot></select>`,
        props: {
            value: {
                type: Array
            }
        }, watch: {
            value(newValue, oldValue) {


                $(this.$el).val(newValue);
                $(this.$el).trigger('change.select2')


            }
        }, mounted() {
            $(this.$el).select2();

            if (this.value) {
                $(this.$el).val(this.value);
                $(this.$el).trigger('change.select2')
            }


            $(this.$el).on("change", () => {
                console.log("onchange");
                var data = $(this.$el).select2('data');

                let v = data.map(s => {
                    return s.id;
                });

                this.$emit("input", v);
            });
        }

    });
</script>