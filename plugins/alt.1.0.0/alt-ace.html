<template id="ace">
    <textarea></textarea>
</template>

<script>
    Vue.component("ace", {
        template: document.currentScript.ownerDocument.getElementById("ace"),
        mounted() {
            var $that = $(this.$el);

            $(this.$el).addClass("hide");
            var $div = $("<div style='height:400px'></div>");
            $div.insertAfter(this.$el);

            var editor = ace.edit($div[0]);
            var mode = $(this.$el).attr("ace-mode");
            if (mode) {
                editor.session.setMode("ace/mode/" + mode);
            }

            editor.getSession().setValue($(this.$el).val());

            editor.getSession().on('change', function () {
//                console.log(editor.getSession().getValue());
                $that.val(editor.getSession().getValue());
            });

            
        }
    });
</script>