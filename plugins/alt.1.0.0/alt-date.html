<script>
    Vue.component("alt-datetime", {
        template: `
    <div>
    <div class="input-group">
        <span class="input-group-addon">
            <i :class="icon"></i>
        </span>
        <input class="form-control" ref="input" v-bind="$props" :value="value" :name="name"/>
        <i v-if="required" class="fa fa-asterisk form-control-feedback" style="top:10px"></i>
    </div>
    </div>
        `,
        props: {
            name: String,
            required: Boolean,
            type: Boolean,
            value: String,
            sideBySide: {
                type: Boolean,
                default: true
            },
            format: {
                type: String,
                default: "YYYY-MM-DD HH:mm"
            },
            icon: {
                type: String,
                default: "far fa-calendar-alt"
            }
        }, mounted() {
            if (this.required) {
                $(this.$el).closest(".form-group").addClass("has-feedback");
                if ($(this.$el).closest(".form-group").length == 0) {
                    $(this.$el).css("margin-bottom", "0px");
                    $(this.$el).addClass("form-group has-feedback");
                }
            }
            $(this.$refs.input).datetimepicker({
                format: this.format
            });
        }
    });

    Vue.component("alt-date", {
        template: `
<div>
    <div class="input-group">
        <span class="input-group-addon">
            <i :class="icon"></i>
        </span>
        <input is="datepicker" ref="datepicker" class="form-control" v-bind="$props"/>
        <i v-if="required" class="fa fa-asterisk form-control-feedback" style="top:10px"></i>
    </div>
</div>
`,
        props: {
            icon: {
                type: String,
                default: "far fa-calendar-alt"
            },
            name: String,
            required: Boolean,
            type: Boolean,
            //            value: String,
            format: {
                type: String,
                default: "yyyy-mm-dd"
            },
            todayHighlight: {
                type: Boolean,
                default: true
            },
            todayBtn: {
                type: String,
                default: "linked"
            },
            autoclose: {
                type: Boolean,
                default: true
            }
        }, mounted() {
            if (this.required) {
                $(this.$el).closest(".form-group").addClass("has-feedback");
                if ($(this.$el).closest(".form-group").length == 0) {
                    $(this.$el).css("margin-bottom", "0px");
                    $(this.$el).addClass("form-group has-feedback");
                }
            }
            if (this.$attrs.value) {
                this.value = this.$attrs.value;
            }
        },
        computed: {
            value: {
                get() {
                    return this.$refs.datepicker.value;
                }, set(newValue) {
                    this.$refs.datepicker.value = newValue;
                }
            }
        }
    });

    Vue.component("datepicker", {
        template: `
<input class="form-control"/>`,
        props: {
            format: {
                type: String,
                default: "yyyy-mm-dd"
            },
            todayHighlight: {
                type: Boolean,
                default: true
            },
            todayBtn: {
                type: String,
                default: "linked"
            },
            autoclose: {
                type: Boolean,
                default: true
            }
        }, data() {
            return {
                datepicker: null,
                val: null
            }
        },
        created() {
        },
        mounted() {
            this.val = this.$el.value;
            this.datepicker = $(this.$el).datepicker(this.$props);
            this.datepicker.on("change", (o) => {
                this.val = this.$el.value;
            });

        }, computed: {
            value: {
                get() {
                    return this.val;
                }, set(newValue) {
                    this.val = newValue;
                    this.$el.value = newValue;
                }
            }
        }
    });
</script>